<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>内网环境搭建</title>
    <link href="/2022/06/14/%E5%86%85%E7%BD%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"/>
    <url>/2022/06/14/%E5%86%85%E7%BD%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h3 id="内网环境介绍"><a href="#内网环境介绍" class="headerlink" title="内网环境介绍"></a>内网环境介绍</h3><ul><li><p>内网介绍</p><ul><li>局域网(Local Area Network，LAN)是指在某一区域内由多台计算机互联成的计算机组。一般是方圆几千米以内。局域网可以实现文件管理、应用软件共享、打印机共享、工作组内的日程安排、电子邮件和传真通信服务等功能。局域网是封闭型的，可以由办公室内的两台计算机组成，也可以由一个公司内的上千台计算机组成。 　</li><li>局域网通常是分布在一个有限地理范围内的网络系统，一般所涉及的地理范围只有几公里。局域网专用性非常强，具有比较稳定和规范的拓扑结构。</li></ul></li><li><p>工作组</p><ul><li>工作组(Work Group)是最常见最简单最普通的资源管理模式，就是将不同的电脑按功能分别列入不同的组中，以方便管理。比如在一个网络内，可能有成百上千台工作电脑，如果这些电脑不进行分组，都列在“网上邻居”内，可想而知会有多么乱(恐怕网络邻居也会显示“下一页”吧)。为了解决这一问题，Windows 9x&#x2F;NT&#x2F;2000 才引用了“工作组”这个概念，比如一所高校，会分为诸如数学系、中文系之类的，然后数学系的电脑全都列入数学系的工作组中，中文系的电脑全部都列入到中文系的工作组中……如果你要访问某个系别的资源，就在“网上邻居”里找到那个系的工作组名，双击就可以看到那个系别的电脑了。<br><img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614220954.png"></li></ul></li><li><p>域</p><ul><li>域是一个有安全边界的计算机集合（安全边界是在两个域中，一个域中的用户无法访问另一个域中的资源），在同一个域中的计算机彼此之间已经建立了信任关系，在域内访问其他机器，不再需要被访问机器的许可了。</li></ul></li><li><p>域控制器（DC）</p><ul><li>域控制器是指在“域”模式下，至少有一台服务器负责每一台联入网络的电脑和用户的验证工作，相当于一个单位的门卫一样，称为“域控制器（Domain Controller，简写为DC。</li></ul></li><li><p>父域和子域</p><ul><li>出于管理及其他的需求，需要在网络中划分多个域！，第一个域为父域，各分部的域称为子域。</li></ul></li><li><p>域树（Tree）</p><ul><li>指若干个域通过建立信任关系而组合成新的集合！</li><li>abc.com及为父域，asia.abc.com为子域，可见有一个子域必须以父域名为后缀名</li></ul></li></ul><h3 id="工作组环境信息收集"><a href="#工作组环境信息收集" class="headerlink" title="工作组环境信息收集"></a>工作组环境信息收集</h3><ul><li><p>域名服务器（Domain Name Server，DNS）</p><ul><li>指用于进行域名（Domain Name）和与之相对应的IP地址（IPAddress）转换的服务器。</li><li>一般内网渗透时，就是寻找DNS服务器来定位DC（DNS服务器和DC通常会处在同一台机器上）</li></ul></li><li><p>活动目录（Active Directory，AD）</p><ul><li>是指域环境中提供目录服务的组件</li><li>管理员可以在活动目录中忽略被管理对象的具体地理位置，而将这些对象按照一定的方式放置在不同的容器中，这种组织架构称之为逻辑架构</li><li>活动目录的逻辑架构包括上面讲到的组织单元（OU）、域、域树、域森林</li></ul></li><li><p>域中计算机的分类</p><ul><li>域控制器（必有）<ul><li>用于管理所有的网络访问</li></ul></li><li>成员服务器<ul><li>安装了服务器系统且加入了域，但没有安装活动目录的计算机</li></ul></li><li>客户机<ul><li>用户使用账号密码登录来访问并调用此间资源</li></ul></li><li>独立服务器<ul><li>和域没有关系。既不加入域也没有安装活动目录的服务器</li></ul></li></ul></li><li><p>域内权限解读</p><ul><li>域本地组<ul><li>域本地组主要用于授予本域内资源的访问权限，不能嵌套其他组中使用。</li></ul></li><li>全局组<ul><li>可以嵌套在其他组中，可以在域森林的任何域内指派权限。</li></ul></li><li>通用组<ul><li>通用组成员来自域森林中任何域的用户账号，全局组和其他通用组，可以在该域森林的任何域中指派权限，可以嵌套其他组中，非常适合在域森林内的跨域访问中使用。</li></ul></li><li>A-G-DL-P策略<ul><li>指用户账号添加到全剧组中，将全局组添加到域本地组中，然后为域本地组分配资源权限。</li></ul></li></ul></li></ul><h3 id="域环境搭建"><a href="#域环境搭建" class="headerlink" title="域环境搭建"></a>域环境搭建</h3><p><strong>域环境搭建配置</strong></p><ol><li>DC配置静态ip，设置dns为自己ip。</li><li>运行输入dcpromo</li><li>创建域名称</li><li>重启改域控管理密码</li><li>将内网计算机加入域网络</li><li>配置域策略到域内计算机</li></ol><h3 id="域环境信息收集"><a href="#域环境信息收集" class="headerlink" title="域环境信息收集"></a>域环境信息收集</h3><ol><li>进入\\neil.com\SYSVOL\Policies</li><li>查看下发策略</li><li>有可能搜集到策略下发的密码</li></ol><h3 id="内网环境拓扑"><a href="#内网环境拓扑" class="headerlink" title="内网环境拓扑"></a>内网环境拓扑</h3><p><img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614224442.png"></p><ul><li>拓扑图解析<ul><li>Kali 作为公网攻击主机</li><li>防火墙屏蔽内网信息 开启端口转发</li><li>Kali 拿到web内网服务器</li><li>通过web横向渗透</li><li>找到某台主机连接另一个内网</li><li>通过该主机作为跳板进行纵向渗透</li><li>发现域网络</li><li>通过域控纵向渗透到核心文件区</li></ul></li></ul>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>编辑器漏洞</title>
    <link href="/2022/06/14/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/"/>
    <url>/2022/06/14/%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h3 id="编辑器路径查找"><a href="#编辑器路径查找" class="headerlink" title="编辑器路径查找"></a>编辑器路径查找</h3><ul><li>查找编辑器目录<ul><li>目录扫描</li><li>目录遍历</li><li>蜘蛛爬行</li><li>扫描编辑器二级目录</li><li>高位端口</li></ul></li><li>注意事项：<ul><li>查找路径时应注意站中站和子站的编辑器路径</li><li>如果进入后台查找编辑器未能正常显示的，可以利用审查元素搜索editor等关键字、或者换低版本浏览器打开查看编辑器</li></ul></li></ul><h3 id="FCK编辑器漏洞"><a href="#FCK编辑器漏洞" class="headerlink" title="FCK编辑器漏洞"></a>FCK编辑器漏洞</h3><p><img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614141559.png"></p><ul><li><p>FCKeditor编辑器页 </p><ul><li>FCKeditor&#x2F;_samples&#x2F;default.html</li></ul></li><li><p>查看编辑器版本</p><ul><li>FCKeditor&#x2F;_whatsnew.html</li></ul></li><li><p>查看文件上传路径</p><ul><li>fckeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;asp&#x2F;connector.asp?Command&#x3D;GetFoldersAndFiles&amp;Type&#x3D;Image&amp;CurrentFolder&#x3D;&#x2F; <br><img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614142320.png"></li></ul></li><li><p>过狗小技巧</p><ul><li>%00阶段上传脚本时遇到阿里云防护可以通过连发三个包过去</li><li>iis 3.0 6.0均存在解析漏洞, 6.0可通过抓包修改 递归创建两个目录<img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614151659.png"></li><li>%00截断不了的话, 在后面加个.<img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614152012.png"></li></ul></li></ul><h3 id="EWEB编辑器漏洞"><a href="#EWEB编辑器漏洞" class="headerlink" title="EWEB编辑器漏洞"></a>EWEB编辑器漏洞</h3><p><img src="https://raw.githubusercontent.com/Neiiiiil/picgo_img/main/20220614153114.png"></p><p><strong>eweb编辑器利用流程</strong></p><ol><li>查找eweb编辑器路径, 找eweb管理后台</li><li>进入后台，修改上传文件类型</li><li>上传脚本拿shell</li><li>如果没有后台<ol><li>看是否能下载数据库，看数据库中有没有可以上传脚本的样式，构造上传</li><li>利用eweb目录遍历漏洞，找到网站数据库，下载破解管理员密码进后台拿shell</li><li>查找对用编辑器版本漏洞利用拿shell</li></ol></li></ol><ul><li><p>eWebEditor利用基础知识</p><ul><li>默认后台地址：&#x2F;ewebeditor&#x2F;admin_login.asp </li><li>数据库路径：[PATH]&#x2F;db&#x2F;ewebeditor.mdb</li><li>[PATH]&#x2F;db&#x2F;db.mdb – 某些CMS里是这个数据库 </li><li>也可尝试 [PATH]&#x2F;db&#x2F;%23ewebeditor.mdb – 某些管理员自作聪明的小伎俩</li></ul></li><li><p>有修改权限的利用</p><ul><li>通过增加样式–设置-添加插入图片-getshell</li><li>不能添加工具栏，但设定好了某样式中的文件类型</li><li>修改action字段<ul><li>比如 ID&#x3D;46 s-name &#x3D;standard1 </li><li>构造 代码: ewebeditor.asp?id&#x3D;content style&#x3D;standard </li><li>ID和和样式名改过后 ewebeditor.asp?id&#x3D;46&amp;style&#x3D;standard1 <br>　　eWebEditor遍历目录漏洞</li></ul></li></ul></li><li><p>无修改权限</p><ul><li>目录遍历<ul><li><a href="http://www.webshell.com/admin/editor/admin_uploadfile.asp?id=&amp;dir=">http://www.webshell.com/admin/editor/admin_uploadfile.asp?id=&amp;dir=</a>..</li></ul></li></ul></li><li><p>eWebEditor 5.2 列目录漏洞</p><ul><li>ewebeditor&#x2F;asp&#x2F;browse.asp</li><li>过滤不严，造成遍历目录漏洞 </li><li>利用WebEditor session欺骗漏洞,进入后台</li></ul></li><li><p>eWebEditor 2.8 商业版插一句话木马</p><ul><li>登陆后台，点击修改密码—新密码设置为 1”:eval request(“h”)’ </li><li>设置成功后，访问asp&#x2F;config.asp文件即可，一句话木马被写入到这个文件里面了.</li></ul></li></ul><p> </p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
